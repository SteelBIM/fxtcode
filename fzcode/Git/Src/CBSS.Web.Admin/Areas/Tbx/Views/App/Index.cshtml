@using CBSS.Web
@using CBSS.Framework.Contract
@using CBSS.Tbx.Contract.DataModel
@using CBSS.Framework.Web.Controls

@model PagedList<App>
@{
    ViewBag.Title = "应用管理管理";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section PageSpecificJavascriptIncludes{
    <link href="~/Content/Scripts/bootstrap-table-develop/src/bootstrap-table.css" rel="stylesheet" />
    <script src="~/Content/Scripts/bootstrap-table-develop/src/bootstrap-table.js"></script>
    <script src="~/Content/Scripts/bootstrap-table-develop/src/locale/bootstrap-table-zh-CN.js"></script>
    <script src="~/Assets/pages/App.js?v=1.2"></script>
    <script type="text/javascript">
           var add = '@ViewBag.Add';
           var edit = '@ViewBag.Edit';
           var del = '@ViewBag.Del';
           var App_AppVersion = '@ViewBag.App_AppVersion';
           var App_AppModule = '@ViewBag.App_AppModule';
           var App_Good = '@ViewBag.App_Good';
           var App_AppSkinVersion = '@ViewBag.App_AppSkinVersion';
        $(document).ready(function () {
            addcloud();
            var oTable = new AppTableInit();
            oTable.Init(edit, del, App_AppVersion, App_AppModule, App_Good, App_AppSkinVersion);
        });
        function DelAppClick(AppID) {
            if (confirm("您确定要删除吗？")) {
                $.post("/App/DelAppByAppID", { AppID: AppID }, function (data) {
                    //alert(data);
                    if (data) {
                        alert(data);
                        window.location.reload();
                    }
                });
            }
        }
    </script>
}
<div class="row-fluid" style="margin-bottom:10px">
    <div class="span4">
        <div>
@if (ViewBag.Add)
{
    <a class="btn green thickbox" title='添加应用' href="@Url.Action("Create")?ModelID=@Request.RequestContext.RouteData.Values["id"]&TB_iframe=true&height=520&width=800">添加应用 <i class="icon-plus icon-white"></i></a>
}       
        </div>
    </div>
</div>
<table class="table table-striped table-hover" id="tb_roletable"></table>

@*<div class="row-fluid">
        <div class="span4">
            <div>
                <a class="btn green thickbox" title='添加应用' href="@Url.Action("Create")?TB_iframe=true&height=520&width=600">添加应用 <i class="icon-plus icon-white"></i></a>
            </div>
        </div>
        <div class="span8">
            @using (Html.BeginForm(null, null, null, FormMethod.Get, new { id = "search" }))
            {
                <div class="dataTables_filter">
                    <label>
                        <button type="submit" class="btn yellow">搜索 <i class="icon-search"></i></button>
                    </label>
                    <label>
                        <span>APP名称：</span>
                        @Html.TextBox("AppName", null, new { @class = "m-wrap small" })
                    </label>
                </div>
            }
        </div>
    </div>

    @using (Html.BeginForm(null, null, FormMethod.Post, new { id = "mainForm" }))
    {
        <table class="table table-striped table-hover ">
            <thead>
                <tr>
                    <th style="width: 8px;">
                            <input type="checkbox" id="checkall" class="group-checkable" />
                        </th>
                    <th>应用ID</th>
                    <th>
                        APP名称
                    </th>
                    <th>
                        应用描述
                    </th>
                    <th>
                        状态
                    </th>
                    <th>
                        发布时间
                    </th>
                    <th>
                        操作
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var m in Model)
                {
                    <tr>
                        <td>
                                <input type="checkbox" class="checkboxes" name='ids' value='@m.AppID' />
                            </td>
                        <td>
                            @m.AppID
                        </td>
                        <td>
                            @m.AppName
                        </td>
                        <td>
                                @(CBSS.Core.Utility.EnumHelper.GetEnumDesc<CBSS.Framework.Contract.Enums.AppTypeEnum>(m.AppType))
                            </td>
                        <td>
                            @m.Describe
                        </td>
                        <td>
                            @(CBSS.Core.Utility.EnumHelper.GetEnumDesc<CBSS.Framework.Contract.StatusEnum>(m.Status))
                        </td>
                        <td>
                            @m.CreateDate.ToString("yyyy-MM-dd HH:mm:ss")
                        </td>
                        <td>
                            <a class="btn mini red thickbox" title='编辑' href="@Url.Action("Edit", new { id = m.AppID })?TB_iframe=true&height=520&width=600">

                                编辑
                                <i class="icon-edit"></i>
                            </a>
                            <a class="btn mini drak" id="mydelete" href="javascript:void(0)" onclick="DelAppClick('@m.AppID')">删除 <i class="icon-trash icon-white"></i></a>
                            <a class="btn mini blue" title='版本管理' href="@Url.Action("Index","AppVersion", new { id = m.AppID })">

                                版本管理
                                <i class="icon-file"></i>
                            </a>
                            <a class="btn mini red" title='配置应用模块' href="@Url.Action("Index","AppModule", new { id = m.AppID })">

                                配置应用模块
                                <i class="icon-edit"></i>
                            </a>
                            <a class="btn mini red thickbox" title='配置商品策略' href="@Url.Action("SelectGood", new { id = m.AppID })?TB_iframe=true&height=520&width=600">
                                    <i class="icon-edit"></i>
                                配置商品策略
                                </a>
                            <a class="btn mini red" title='皮肤管理' href="@Url.Action("Index","AppSkinVersion", new { id = m.AppID })">

                                皮肤管理
                                <i class="icon-edit"></i>
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    <div class="dataTables_paginate paging_bootstrap pagination">
        @Html.Pager(Model, new PagerOptions() { ShowTotalItemCount = true })
    </div>

    <script src="@Url.StaticFile("/assets/js/jquery-1.8.3.min.js")"></script>
    <script type="text/javascript">
        function DelAppClick(AppID) {
            if (confirm("您确定要删除吗？")) {
                $.post("/App/DelAppByAppID", { AppID: AppID }, function (data) {
                    //alert(data);
                    if (data) {
                        alert(data);
                        window.location.reload();
                    }
                });
            }
        }
    </script>*@