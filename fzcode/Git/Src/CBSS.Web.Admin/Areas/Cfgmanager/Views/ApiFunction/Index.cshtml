@using CBSS.Web
@using CBSS.Core.Utility
@using CBSS.Framework.Contract
@using CBSS.Framework.Web.Controls
@{
    ViewBag.Title = "Index";
}
@using CBSS.Cfgmanager.Contract.DataModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section PageSpecificJavascriptIncludes{
    <link href="~/Content/Scripts/bootstrap-table-develop/src/bootstrap-table.css" rel="stylesheet" />
    <script src="~/Content/Scripts/bootstrap-table-develop/src/bootstrap-table.js"></script>
    <script src="~/Content/Scripts/bootstrap-table-develop/src/locale/bootstrap-table-zh-CN.js"></script>
    <script src="~/Assets/pages/ApiFunction.js?v=1.1"></script>
    <script type="text/javascript">
        var add = '@ViewBag.Add';
        var edit = '@ViewBag.Edit';
        var del = '@ViewBag.Del';
        $(document).ready(function () {
            addcloud();
            var oTable = new ApiFunctionTableInit();
            oTable.Init(edit);
        });
    </script>
}
<div class="row-fluid">
    <div class="span4">
        <div>
            @if (ViewBag.Del != null)
            {
                if (ViewBag.Del)
                {
                    <a class="btn red" id="deletes" href="javascript:;">删除 <i class="icon-trash icon-white"></i></a>
                }
            }
            @if (ViewBag.Add != null)
            {
                if (ViewBag.Add)
                {
                    <a class="btn green thickbox" title='' href="@Url.Action("Create")?TB_iframe=true&width=1000&height=800">新增 <i class="icon-plus icon-white"></i></a>
                }
            }
            @if (ViewBag.ApiFunction_ApiDocument != null)
            {
                if (ViewBag.ApiFunction_ApiDocument)
                {
                    <a class="btn green" id="btnApiDocument" target="_blank" href="javascript:void(0)" onclick="ApiDocumentClick()">接口文档 <i class="icon-file icon-white"></i></a>
                }
            } 
        </div>
    </div>
    <div class="span8" style="margin-bottom: 20px;">
        <div class="dataTables_filter">
            <label>
                <button type="submit" id="searchbtn" class="btn yellow">搜索 <i class="icon-search"></i></button>
            </label>
            <label>
                <span>系统名称：</span>
                @Html.DropDownList("SystemCode", "...请选择...")
            </label>
            <label>
                <span>接口名称：</span>
                @Html.TextBox("ApiFunctionName", null, new { @class = "m-wrap small" })
            </label>
        </div>
    </div>
</div>
<table class="table table-striped table-hover" id="tb_roletable"></table>
@*@using (Html.BeginForm("Delete", "ApiFunction", FormMethod.Post, new { id = "mainForm" }))
    {
        <table class="table table-striped table-hover ">
            <thead>
                <tr>
                    <th style="width: 8px;">
                        <input type="checkbox" id="checkall" class="group-checkable" />
                    </th>
                    <th>
                        系统名称
                    </th>
                    <th>
                        接口名称
                    </th>
                    <th>
                        接口描述
                    </th>
                    <th class="hidden-480">
                        接口地址
                    </th>
                    <th>
                        接口方式
                    </th>
                    <th>
                        操作
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var m in Model)
                {
                    <tr>
                        <td><input type="checkbox" class="checkboxes" name='ids' value='@m.ApiFunctionID' /></td>
                        <td>
                            @(CBSS.Core.Utility.EnumHelper.GetEnumDesc<CBSS.Framework.Contract.Enums.SystemCodeEnum>(m.SystemCode))
                        </td>
                        <td>
                            @m.ApiFunctionName
                        </td>
                        <td>
                            @m.ApiFunctionExplain
                        </td>
                        <td>
                            @m.ApiFunctionUrl
                        </td>
                        <td>
                            @(CBSS.Core.Utility.EnumHelper.GetEnumDesc<CBSS.Framework.Contract.Enums.ApiFuncWayEnum>(m.ApiFunctionWay))
                        </td>
                        <td>
                            @if (ViewBag.Edit)
                            {
                                <a class="btn mini red thickbox" title='编辑' href="@Url.Action("Edit", new { id = m.ApiFunctionID })?TB_iframe=true&width=1000&height=800">
                                    <i class="icon-edit"></i>
                                    编辑
                                </a>
                            }
                        </td>
                    </tr>

                }
            </tbody>
        </table>
    }*@
<script src="@Url.StaticFile("/assets/js/jquery-1.8.3.min.js")"></script>
<script type="text/javascript">
    function ApiDocumentClick() {
        var chk_value = [];
        $('input[name="ids"]:checked').each(function () {
            chk_value.push($(this).val());
        });
        var ApiFunctionName = $("#ApiFunctionName").val().trim();
        var SystemCode = $("#SystemCode").val().trim();
        var parms = "ApiFunctionName=" + ApiFunctionName + "&SystemCode=" + SystemCode + "";
        window.open("/Cfgmanager/ApiFunction/ApiDocument?" + parms);
    }
</script>
@*<div class="dataTables_paginate paging_bootstrap pagination">
        @Html.Pager(Model, new PagerOptions() { ShowTotalItemCount = true })
    </div>*@
