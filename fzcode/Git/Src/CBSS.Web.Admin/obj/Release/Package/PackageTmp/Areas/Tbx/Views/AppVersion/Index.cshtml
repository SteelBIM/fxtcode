@using CBSS.Web
@using CBSS.Framework.Contract
@using CBSS.Tbx.Contract.ViewModel
@using CBSS.Framework.Web.Controls

@{
    ViewBag.Title = "版本管理";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section PageSpecificJavascriptIncludes{
    <link href="~/Content/Scripts/bootstrap-table-develop/src/bootstrap-table.css" rel="stylesheet" />
    <script src="~/Content/Scripts/bootstrap-table-develop/src/bootstrap-table.js"></script>
    <script src="~/Content/Scripts/bootstrap-table-develop/src/locale/bootstrap-table-zh-CN.js"></script>
    <script src="~/Assets/pages/AppVersion.js?v=1.5"></script>
    <script type="text/javascript">   
        $(document).ready(function () {
            var appType = getQueryString("AppType");
            addcloud();
            $("#AppType").val(appType);
            if (appType == 1) {
                $("#btnAndroid").attr("class", "btn yellow");
                $("#btnIos").attr("class", "btn btnReYellow"); 
            } else {
                $("#btnAndroid").attr("class", "btn btnReYellow");
                $("#btnIos").attr("class", "btn yellow");
            }
            var oTable = new AppVersionTableInit();
            oTable.Init();
        });
        function btnReloadClick(appType) {
            window.location.href = "/Tbx/AppVersion/Index/" + $("#HidAppID").val() + "?AppType=" + appType;
        }
    </script>
    <style type="text/css">
        .btnReYellow {
            background-color: white;
            color: black;
            border: 1px solid;
        }
    </style>
}
<div class="row-fluid">
    <div class="span4">
        <div> 
    <a class="btn green thickbox" title='新增版本' href="@Url.Action("Create")?TB_iframe=true&height=520&width=800">新增版本 <i class="icon-plus icon-white"></i></a> 
        </div>
    </div>
    <div class="span8" style="margin-bottom: 20px;    text-align: right;">
        @*<div class="dataTables_filter" style="display:none;">
            <label>
                <button type="submit" id="searchbtn" class="btn yellow">搜索 <i class="icon-search"></i></button>
            </label>
            <label>
                <span>应用类别：</span>
                @Html.DropDownList("AppType")
            </label>
        </div>*@
        <input type="button" id="btnAndroid" value="安卓" class="btn yellow"  style="width:100px;" onclick="btnReloadClick(1)" />
        <input type="button" id="btnIos" value="Ios" class="btn btnReYellow"  style="width:100px;" onclick="btnReloadClick(2)"/>
        <input type="hidden" id="AppType" value="1" />
        <input type="hidden" id="HidAppID" value="@Request.RequestContext.RouteData.Values["id"].ToString()" />
    </div>
</div>
<table class="table table-striped table-hover" id="tb_roletable"></table>

@*<div class="row-fluid">
        <div class="span4">
            <div>
                <a class="btn green thickbox" title='添加版本' href="@Url.Action("Create", new { id = Request.RequestContext.RouteData.Values["id"]})?TB_iframe=true&height=600&width=700">添加版本 <i class="icon-plus icon-white"></i></a>
            </div>
        </div>
        <div class="span8" style="margin-bottom: 20px;">
            @using (Html.BeginForm(null, null, null, FormMethod.Get, new { id = "search" }))
                {
                <div class="dataTables_filter">
                    <label>
                        <button type="submit" class="btn yellow">搜索 <i class="icon-search"></i></button>
                    </label>
                    <label>
                        <span>应用类别：</span>
                        @Html.DropDownList("AppType")
                    </label>
                </div>
            }
        </div>
    </div>

    @using (Html.BeginForm("Delete", "Model", FormMethod.Post, new { id = "mainForm" }))
    {
        <table class="table table-striped table-hover ">
            <thead>
                <tr>
                    <th style="width: 8px;">
                            <input type="checkbox" id="checkall" class="group-checkable" />
                        </th>
                    <th>版本号</th>
                    <th>
                        类别
                    </th>
                    <th>
                        应用名称
                    </th>
                    <th>
                        版本描述
                    </th>
                    <th>
                        更新类型
                    </th>
                    <th>
                        是否强制更新
                    </th>
                    <th>
                        状态
                    </th>
                    <th>
                        发布时间
                    </th>
                    <th>
                        操作
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var m in Model)
                {
                    <tr>
                        <td>
                                <input type="checkbox" class="checkboxes" name='ids' value='@m.AppID' />
                            </td>
                        <td>
                            @m.AppVersionNumber
                        </td>
                        <td>
                            @(CBSS.Core.Utility.EnumHelper.GetEnumDesc<CBSS.Framework.Contract.Enums.AppTypeEnum>(m.AppType))
                        </td>
                        <td>
                            @m.AppName
                        </td>
                        <td>
                            @m.AppVersionDescribe
                        </td>
                        <td>
                            @(CBSS.Core.Utility.EnumHelper.GetEnumDesc<CBSS.Framework.Contract.Enums.AppVersionUpdateTypeEnum>(m.AppVersionUpdateType))
                        </td>
                        <td>
                            @(m.IsForcedUpdate == 1 ? "是" : "否")
                        </td>
                        <td>
                            @(CBSS.Core.Utility.EnumHelper.GetEnumDesc<CBSS.Framework.Contract.StatusEnum>(m.Status))
                        </td>
                        <td>
                            @m.CreateDate.ToString("yyyy-MM-dd HH:mm:ss")
                        </td>
                        <td>
                            <a class="btn mini purple thickbox" title='编辑' href="@Url.Action("Edit", new { id = m.AppVersionID })?TB_iframe=true&height=520&width=600">
                                <i class="icon-edit"></i>
                                编辑
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    <div class="dataTables_paginate paging_bootstrap pagination">
        @Html.Pager(Model, new PagerOptions() { ShowTotalItemCount = true })
    </div>

    <script src="@Url.StaticFile("/assets/js/jquery-1.8.3.min.js")"></script>
    <script type="text/javascript">
        function DelModelClick(ModelID) {
            if (confirm("您确定要删除吗？")) {
                alert(ModelID);
            }
        }
    </script>*@