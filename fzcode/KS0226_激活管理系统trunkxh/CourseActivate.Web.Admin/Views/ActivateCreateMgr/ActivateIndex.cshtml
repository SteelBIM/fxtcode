@{
    ViewBag.Title = "Index";
    Layout = "~/Views/_LayoutHome.cshtml";
    string startday = DateTime.Now.Year + "-" + (DateTime.Now.Month < 10 ? ("0" + DateTime.Now.Month) : DateTime.Now.Month.ToString() )+ "-01";
    string endday =DateTime.Parse( startday).AddMonths(1).AddDays(-1).ToString("yyyy-MM-dd");
}

<h2>Index2</h2>

@section cssLink{
    <link href="~/Content/bootstrap-table-develop/src/bootstrap-table.css" rel="stylesheet" />

}

@section mainContent{
    <div class="col-lg-12">
        <h1 class="page-header">激活码管理</h1>
    </div>
    <div class="tree" style="width:10%; float:left; overflow-x:auto; background-color:#fff;">
        <div id="tree">
        </div>
    </div>
    <div class="row" style=" width:100%; float:left; margin-left:0;">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-body" style="padding-bottom:0px;">
                    <div class="col-lg-12">
                        <div class="col-xs-3">
                            <div class="col-sm-4" style="text-align:right;">
                                <label class="control-label" style="line-height:30px">开始时间:</label>                                
                            </div>
                            <div class="col-sm-8">
                                <input id="startdate" style="height: 35px; width: 100%" type="date" value="@startday" />                                
                            </div>
                        </div>
                        <div class="col-xs-3">
                            <div class="col-sm-4" style="text-align:right;">
                                <label class="control-label" style="line-height: 30px;">结束时间:</label>
                            </div>
                            <div class="col-sm-8">
                                <input id="enddate" style="height: 35px; width: 100%" type="date" value="@endday" />
                            </div>
                        </div>
                        <div class="col-xs-3">
                            <div class="col-sm-4" style="text-align:right;">
                                <label class="control-label" style="line-height:30px">关联课程ID:</label>
                            </div>
                            <div class="col-sm-8">
                                <input id="bookid" class=" form-control" type="text" />
                            </div>
                        </div>
                        <div class="col-xs-3">
                            <div class="col-sm-4" style="text-align:right;">
                                <label class="control-label" style="line-height:30px">出版社:</label>
                            </div>
                            <div class="col-sm-8">
                                <select id="publishid" class="selectpicker show-tick form-control" data-live-search="true">
                                    <option value="">全部</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12" style="margin-top:20px;">
                        <div class="col-xs-3">
                            <div class="col-sm-4" style="text-align:right;">
                                <label class="control-label" style="line-height:30px">类&nbsp;&nbsp;&nbsp;&nbsp;型:</label>
                            </div>
                            <div class="col-sm-8">
                                <select id="SelectActivateType" class="selectpicker show-tick form-control" data-live-search="true">
                                    <option value="-1" selected="selected">请选择类型</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-xs-3">
                            <div class="col-sm-4" style="text-align:right;">
                                <label class="control-label" style="line-height:30px">状&nbsp;&nbsp;&nbsp;&nbsp;态:</label>
                            </div>
                            <div class="col-sm-8">
                                <select id="state" class="selectpicker show-tick form-control" data-live-search="true">
                                    <option value="-1">全部</option>
                                    <option value="1">已启用</option>
                                    <option value="0">未启用</option>
                                    <option value="2">已禁用</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-xs-3">
                            <button id="searchbtn" onclick="$('#tb_activatetype').bootstrapTable('refresh')" type="button" class="btn btn-default" style="float:left; margin-left:20px;width:80px; height:34px; background-color:#515562; color:#fff;">
                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span>查询
                            </button>
                           
                        </div>
                        <div class="col-xs-12" style="padding-top:30px;">
                            <button onclick="Create()" type="button" class="btn btn-primary" style="width: 80px; height: 34px; margin-left: 15px;float:left; background-color: #515562">生成</button>
                            <button onclick="Import()" type="button" class="btn btn-primary" style="width: 80px; height: 34px; margin-left: 1px; float: left; background-color: #515562;margin-left:20px;">导入</button>
                        </div>
                    </div>
                    <div style="margin-top:20px;">

                        <div style="clear:both;"></div>
                        <div id="toolbar" class="btn-group">
                        </div>

                        <table id="tb_Statisticbook"></table>
                    </div>
                </div>

                <div class="panel-body" style="padding-bottom:0px;padding-top:0px;">
                    <div style="clear:both;"></div>
                    <div id="toolbar" class="btn-group">
                    </div>
                    <table id="tb_activatetype"></table>
                    <div class="modal fade" id="setbpolicypr" style=" overflow:auto;" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div style="clear:both; height:50px;"></div>
                                <form id="PolicyForm" method="post" class="form-horizontal" style=" width:100%;" action="#">
                                    <div class="row">
                                        <div class="form-group">
                                            <label class="col-lg-3 control-label"><em>*</em>激活码类型:</label>
                                            <div class="col-lg-5">
                                                <select id="publish" class="selectpicker show-tick form-control" data-live-search="true">
                                                    <option value="">全部</option>

                                                </select>
                                            </div>
                                        </div>
                                        <div style="clear:both;"></div>
                                        <div class="form-group">
                                            <label class="col-lg-3 control-label"><em>*</em>出版社:</label>
                                            <div class="col-lg-5">
                                                <select id="publish" class="selectpicker show-tick form-control" data-live-search="true">
                                                    <option value="">全部</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-lg-3 control-label"><em>*</em>应用类型:</label>
                                            <div class="col-lg-5">
                                                <select id="type" class="selectpicker show-tick form-control" data-live-search="true">
                                                    <option value="0">全部</option>
                                                    <option value="1">PC客户端</option>
                                                    <option value="2">APP端</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div style="clear:both;"></div>
                                        <div class="form-group">
                                            <label class="col-lg-3 control-label"><em>*</em>购买方式:</label>
                                            <div class="col-lg-5">
                                                <select id="buyway" class="selectpicker show-tick form-control" data-live-search="true">
                                                    <option value="1">线上</option>
                                                    <option value="2">线下</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div style="clear:both;"></div>
                                        <div class="form-group">
                                            <label class="col-lg-3 control-label"><em>*</em>可激活设备:</label>
                                            <div class="col-lg-5">
                                                <input type="text" data-options="" class="form-control" id="device" />
                                            </div>
                                        </div>
                                        <div style="clear:both;"></div>
                                        <div class="form-group">
                                            <label class="col-lg-3 control-label"> 备注:</label>
                                            <div class="col-lg-5" style=" width:274px;">
                                                <textarea class="form-control" style="height:80px;" id="Remark" name="Remark"></textarea>
                                            </div>

                                        </div>
                                    </div>
                                </form>
                                <div style="clear:both; height:50px;"></div>
                                <div class="modal-footer">
                                    <input type="hidden" id="policyid" value="0" />
                                    <button type="button" class="btn btn-primary" id="btn_setdata" onclick="saveData(0)">确定</button>
                                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@section jsSrc{
    <script src="~/Content/bootstrap-table-develop/src/bootstrap-table.js"></script>
    <script src="~/Content/bootstrap-table-develop/src/locale/bootstrap-table-zh-CN.js"></script>
    <script src="~/Scripts/bootbox.js"></script>
    <script src="~/Scripts/pages/ActivateManagement.js"></script>
    <script src="~/Scripts/bootstrap-treeview.js"></script>
    <script>
        function Create() {
            window.location.href = "@Url.Action("CreateActCode")";
        }
        function Import() {
            window.location.href = "@Url.Action("Index", "ImportExcel", new { })";
        }
        var pageInit;
        $(function () {
            pageInit = new ActivateManagement();
            pageInit.Init();
        })

        var GetActivateType = function () {
            $.post("/ImportExcel/GetActivateType", function (data) {
                if (data != null) {
                    for (var i = 0; i < data.length; i++) {
                        var result = data[i];
                        var html = '';
                        html += ' <option value="' + result.activatetypeid + '">' + result.activatetypename + '</option>';
                        $(html).appendTo("#SelectActivateType");
                    }
                }
            });
        }
        $(function () {
            GetActivateType();
        })
    </script>
}
