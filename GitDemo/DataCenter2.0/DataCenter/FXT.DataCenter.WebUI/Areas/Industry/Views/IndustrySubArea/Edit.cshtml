@model FXT.DataCenter.Domain.Models.SYS_SubArea_Industry
@{
    ViewBag.Title = "工业片区";
}

@section StyleSheet{
    <style type="text/css">
        #tbInputCon
        {
            margin-top: 10px;
            margin-left: 30px;
            width: 95%;
            font-size: 14px;
            font-weight: normal;
            line-height: 20px;
            font-family: "Microsoft Yahei", "微软雅黑", "宋体", "Simsun", "Open Sans";
        }

        .required
        {
            color: red;
        }

        .btn
        {
            margin-bottom: 10px;
        }
    </style>

}
@section JavaScript{
    <!--//百度地图的文件-->
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=1.4"></script>
    <script src="@Url.Content("~/Content/layer-v1.7.1/layer/layer.min.js?ab")" type="text/javascript"></script>
    <script src="~/Areas/Industry/Scripts/IndustrySubArea.js"></script>
    <script type="text/javascript">
        var cityX = "@ViewBag.CityX";
        var cityY = "@ViewBag.CityY";
        $(document).ready(function () {
            //面包屑导航
            $("#navigation .breadcrumb li:eq(1)").remove();
            $("#navigation .breadcrumb li:eq(2)").remove();
            var html = "<li><span><a href=\"/Industry/IndustrySubArea/Index\">工业片区</a></span> <i class=\"icon-angle-right\"></i></li>";
            if ('@Model' == "") {
                html += "<li><span>新增</span></li>";
            } else {
                html += "<li><span>编辑</span></li>";
            }

            $("ul.breadcrumb").append(html);

            //确定
            $("#btnSave").bind("click", function () {
                var areaId = $("#AreaId").val();
                var subAreaId = $("#SubAreaId").val();
                var subAreaName = $.trim($("#SubAreaName").val());

                if (areaId == -1 || subAreaName == "") {
                    if (areaId == -1) {
                        $("#msgForAreaId").text("*必选");
                    }
                    else {
                        $("#msgForAreaId").text("*");
                    }
                    if (subAreaName == "") {
                        $("#msgForSubAreaName").text("*必填");
                    }
                    else {
                        $("#msgForSubAreaName").text("*");
                    }
                    return;
                }
                else {
                    $("#msgForAreaId").text("*");
                    $("#msgForSubAreaName").text("*");
                }
                $.post('@Url.Action("IsExistSubAreaIndustry")', { areaId: areaId, subAreaId: subAreaId, subAreaName: subAreaName }, function (data) {
                    if (data) {
                        alert("该片区已存在");
                    } else {
                        $("#mainForm").submit();
                    }
                });
            });
        });
    </script>
}

@using (Html.BeginForm(null, null, FormMethod.Post, new { id = "mainForm" }))
{
    <table id="tbInputCon" class="tbInputCon">
        <tr>
            <td>行政区:
            </td>
            <td>
                @if (Model != null)
                {
                    @Html.HiddenFor(m => m.SubAreaId)
                    @Html.HiddenFor(m => m.AreaId)
                    @Html.HiddenFor(m => m.FxtCompanyId)
                    @Html.TextBoxFor(m => m.AreaName, new { @readonly = "readonly" })
                }
                else
                {
                    @Html.HiddenFor(m => m.SubAreaId, new { Value = "-1" })
                    @Html.HiddenFor(m => m.FxtCompanyId)
                    @Html.DropDownListFor(m => m.AreaId, ViewBag.AreaName as List<SelectListItem>)
                    <span class="required" id="msgForAreaId">*</span>
                }
            </td>
            <td>工业片区:
            </td>
            <td>
                @Html.TextBoxFor(m => m.SubAreaName)
                <span class="required" id="msgForSubAreaName">*</span>
            </td>
        </tr>
        <tr>
            <td>环线：
            </td>
            <td colspan="3">
                @Html.TextBoxFor(m => m.AreaLine)
            </td>
        </tr>
        <tr>
            <td>X坐标:
            </td>
            <td>
                @Html.TextBoxFor(m => m.X, new { @readonly = "readonly" })
            </td>
            <td>Y坐标:
            </td>
            <td>
                @Html.TextBoxFor(m => m.Y, new { @readonly = "readonly" })
                <a href="javascript:void(0)" id="GetCoordinate">拾取坐标</a>
                <a href="javascript:void(0)" id="MapCallout">地图标注</a>
            </td>
        </tr>
        <tr>
            <td>描述：
            </td>
            <td>
                @Html.TextBoxFor(m => m.Details)
            </td>
            <td colspan="2">
                @Html.HiddenFor(m => m.LngOrLat)
            </td>
        </tr>
        <tr>
            <td colspan="4" style="padding-top: 10px;">
                <a id="btnSave" class="btn blue" title='保存'><i class="icon-ok"></i>保存</a>
                @if (Model != null)
                {
                    <a class="btn " target="_blank" href="@Url.Action("Index", "IndustryProject", new { SubAreaId = Model.SubAreaId })"><i class=" icon-share-alt"></i>工业楼盘</a>
                }
            </td>
        </tr>
    </table>
}
<div id="baidumap" style="display: none;">
    <div style="width: 100%">
        <div style="margin-top: 10px; margin-left: 20px; float: left; width: 100%">
            城市或地名:
            <input id="txtarea" type="text" style="width: 100px;" />&nbsp;&nbsp;<a class="btn" id="areaSearch">搜索<i class="icon-search"></i></a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a id="btn_xy" class="btn GetCoordinate" style="margin-bottom: 10px;">确定</a>&nbsp;&nbsp;
            <a id="btnClrearCallout" class="btn GetCoordinate" style="margin-bottom: 10px;">取消</a>&nbsp;&nbsp;

            <a style="margin-bottom: 10px;" id="btnPaintline" class="btn MapCallout">绘制线</a> &nbsp;&nbsp;
            <a style="margin-bottom: 10px;" id="btnlinereset" class="btn MapCallout">重 置</a> &nbsp;&nbsp;
            <a style="margin-bottom: 10px;" id="btnlineok" class="btn MapCallout">确 定</a> &nbsp;&nbsp;
            <a style="margin-bottom: 10px;" id="btnClrearLine" class="btn MapCallout">取消</a>
        </div>
    </div>
    <div style="width: 860px; height: 450px; border: 1px solid gray; text-align: center;" id="container">
    </div>
</div>
