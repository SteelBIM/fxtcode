@model FXT.DataCenter.Domain.Models.LNKPPhoto
@{
    Layout = "~/Views/Shared/_Layout.Edit.cshtml";
}
@{
    ViewBag.Title = "工业楼盘图片编辑";
}
@section PageSpecificStyleSheetIncludes{
    <link href="/Content/Scripts/uploadify-v3.2/uploadify.css" rel="stylesheet" />
}
@section PageSpecificJavascriptIncludes{
    <script type="text/javascript" src="@Url.Content("~/Content/Scripts/uploadify-v3.2/jquery.uploadify-3.2.min.js?ver=")@DateTime.Now.Ticks"></script>
    <script type="text/javascript">
        var auth = "@(Request.Cookies[FormsAuthentication.FormsCookieName] == null ? string.Empty : Request.Cookies[FormsAuthentication.FormsCookieName].Value)";
        var ASPSESSID = "@Session.SessionID";
        var isoss = "@ViewBag.IsOss";
        $(function () {
            //setTimeout(function () {
                
            //}, 10);
            $("#file_upload").uploadify({
                //buttonImage:'/Content/Images/buttom_upload.jpg',
                buttonText: "选择您的图片",
                height: 36,
                width: 120,
                multi: false,
                fileTypeDesc: '图片类型', //文件描述
                fileTypeExts: "*.jpg;*.jpeg;*.gif;*.png;*.bmp", //上传的图片格式
                swf: '/Content/Scripts/uploadify-v3.2/uploadify.swf',
                fileSizeLimit: 5120, //限于500kb的文件
                uploader: '/Industry/IndustryProject/UploadPicture',
                uploadLimit: 10, //上传文件个数
                formData: { projectId: '@(ViewBag.projectId)', ASPSESSID: ASPSESSID, AUTHID: auth },
                    onUploadSuccess: function (file, data, response) {
                        eval("data=" + data);
                        if (data.result) {
                            var path = (isoss.toUpperCase() == "TRUE" ? "@ViewBag.OssImgServer" + data.path : data.path);
                            $("#imgPath").attr("src", path);
                            $("#Path").val("").val(data.path);
                        } else {
                            alert(data.msg);
                        }
                    }
            });
        });
    </script>
}
@section MainContent{
    <div class="portlet-body form-horizontal form-bordered form-row-stripped">
        <div class="row-fluid">
            <div class="control-group">
                <label class="control-label">
                    图片名称：
                </label>
                <div class="controls">
                    @if (Model != null)
                    {
                        @Html.HiddenFor(m => m.Id)
                        @Html.HiddenFor(m => m.CityId)
                        @Html.HiddenFor(m => m.FxtCompanyId)
                    }
                    @Html.TextBoxFor(m => m.PhotoName)
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">
                    图片类型：
                </label>
                <div class="controls">
                    @Html.DropDownListFor(m => m.PhotoTypeCode, ViewBag.PhotoTypeName as List<SelectListItem>)
                    <span id="msgForPhotoTypeCode" style="color: red;">*</span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">
                    图片：
                </label>
                <div class="controls">
                    <input type="file" id="file_upload" name="file_upload" value="" />
                </div>
            </div>
            @{
                var path = Model == null ? "/Content/Images/no_picture.jpg" : (@ViewBag.IsOss ? @ViewBag.OssImgServer + Model.Path : Model.Path);
            }
            <img id="imgPath" style="height:200px;width:350px;" src="@path" />
            @Html.HiddenFor(m => m.Path)
        </div>
    </div>
}
