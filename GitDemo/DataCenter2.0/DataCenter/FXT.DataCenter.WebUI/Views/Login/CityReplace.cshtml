@using FXT.DataCenter.Domain.Models
@using FXT.DataCenter.WebUI.Infrastructure.WebSecurity
@{
    Layout = null;
}
@model IEnumerable<dynamic>
<!DOCTYPE html>
<html>
<head>
    <title>切换城市</title>
    <style type="text/css">
        #content ul, #content ul li {
            padding: 0px 5px;
            margin: 0;
        }

        #content li {
            list-style: none;
            float: left;
            display: block;
        }

        #content ul {
            margin-left: 20px;
            height: 100%;
            overflow: hidden;
        }

            #content ul a {
                height: 36px;
                line-height: 36px;
                overflow: hidden;
                color: #808080;
                text-decoration: none;
            }

        .input {
            height: 36px;
            line-height: 36px;
            color: #000;
            padding-left: 30px;
        }

        h3 {
            padding: 0;
            margin: 0;
        }
    </style>
    <link href="@Url.Content("~/Content/assets/css/metro.css")" rel="stylesheet" />
    <script src="/Content/Assets/js/jquery-1.8.3.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $("#block_price ul li").live("click", function () {
                var cid = $(this).find("a").attr("id");
                $.ajax({
                    type: "POST",
                    datatype: "Json",
                    url: "/login/CityReplace",
                    data: { cityId: cid },
                    cache: false,
                    success: function (jsondata) {
                        if (jsondata.flag) {
                            parent.location.reload(1);
                            top.tb_remove();
                        }
                    }

                });
            });
            $("#btnSeachCityName").on("click", function () {
                var cityName = $.trim($("#txtSeachCityName").val());
                $.post("/login/CitySeach", { cityName: cityName }, function (jsondata) {
                    $("#block_price").find("ul").empty();
                    if (jsondata != null && jsondata.length > 0) {
                        for (var i = 0; i < jsondata.length; i++) {
                            $("#block_price").find("ul").append("<li><a href=\"javascript:void(0)\" id='" + jsondata[i].cityid + "' name='" + jsondata[i].cityid + "'>" + jsondata[i].CityName + "</a></li>");
                        }
                    }
                }, "json");
            });
        });
    </script>
</head>
<body>

    <div id="content">
        @{
            var citylist = (Passport.Current.AccessedCities).OrderBy(m => m.cityid).ToList();
        }

        <div class="input">
            <label>城市名:</label><input class="m-wrap" type="text" id="txtSeachCityName" />
            <a id="btnSeachCityName" class="btn">搜 索</a>
        </div>

        <div class="block_price" id="block_price">
            @* <h3>
                        湖南省
                    </h3>*@
            <ul>
                @foreach (var item in citylist)
                {
                    <li><a href="javascript:void(0)" id="@(item.cityid)" name="@(item.cityid)">@item.CityName</a></li>
                }
            </ul>
        </div>
    </div>
</body>
</html>
