@using Webdiyer.WebControls.Mvc

@model FXT.DataCenter.WebUI.Areas.House.Models.ProjectStatics
@section StyleSheet{
    <style type="text/css">
        legend {
            font-weight: 300 !important;
            font-size: 18px;
        }

        .tbsta {
            margin-left: 10px;
        }

            .tbsta input[type='text'], select {
                margin-bottom: 0px;
            }

        input[type='checkbox'] {
            margin-top: 0px;
            margin-bottom: 15px;
        }

        div.pagination {
            text-align: right;
            margin-top: 20px;
        }

        input[type='radio'] {
            margin-bottom: 20px;
        }
    </style>
}
@section Javascript{
    <script type="text/javascript">
        var UrlBHCountExport = '@Url.Action("BHCountExport")';
        var UrlPPCountExport = '@Url.Action("PPCountExport")';

        $(document).ready(function () {
            $('#myTab a').click(function (e) {
                e.preventDefault();
                $(this).tab('show');
            });

            var active = '@ViewBag.active';
            if (active == "") {
                $("#myTab a:first").tab('show');
            }
            $("#myTab li").each(function () {
                var hre = $(this).children("a").attr("href");
                if (active == hre) {
                    $(this).addClass("active");
                    $(active).addClass("active");
                }
            });

            var bhareaname = "@ViewBag.bhareaname";
            if (bhareaname != "") {
                var bhareanamelist = bhareaname.split(',');
                for (var i = 0; i < bhareanamelist.length; i++) {
                    $("input[name=bhareaname]").each(function () {
                        if (this.value == bhareanamelist[i]) {
                            $(this).attr("checked", true);
                        }
                    });
                }
                var flag = true;
                $("input[name=bhareaname]").each(function () {
                    flag = flag && $(this).prop("checked");
                });
                $("#bhAreanameCheckAll").prop("checked", flag);
                $.uniform.update();
            }

            var ppareaname = "@ViewBag.ppareaname";
            if (ppareaname != "") {
                var ppareanamelist = ppareaname.split(',');
                for (var i = 0; i < ppareanamelist.length; i++) {
                    $("input[name=ppareaname]").each(function () {
                        if (this.value == ppareanamelist[i]) {
                            $(this).attr("checked", true);
                        }
                    });
                }
                var flag = true;
                $("input[name=ppareaname]").each(function () {
                    flag = flag && $(this).prop("checked");
                });
                $("#ppAreanameCheckAll").prop("checked", flag);
                $.uniform.update();
            }

            //楼盘房号统计
            $("#btnQuery1").click(function () {
                $("#Type").val("BHCount");
                $("#form1").attr("action", "Count");
            });

            //楼盘房号统计导出
            $("#btnExport1").click(function () {
                $("#form1").attr("action", UrlBHCountExport);
            });

            //楼盘图片统计
            $("#btnQuery2").click(function () {
                $($("input[name='Type']").get(1)).val("PPCount");
                $("#form2").attr("action", '@Url.Action("Count")');
            });

            //楼盘图片统计导出
            $("#btnExport2").click(function () {
                $("#form2").attr("action", UrlPPCountExport);
            });

            $("#bhAreanameCheckAll").click(function () {
                if ($(this).is(":checked")) {
                    $("input[name='bhareaname']").each(function () {
                        $(this).parent().addClass("checked");
                        $(this).attr("checked", true);
                    });
                } else {
                    $("input[name='bhareaname']").each(function () {
                        $(this).parent().removeClass("checked");
                        $(this).attr("checked", false);
                    });
                }
            });
            $("#ppAreanameCheckAll").click(function () {
                if ($(this).is(":checked")) {
                    $("input[name='ppareaname']").each(function () {
                        $(this).parent().addClass("checked");
                        $(this).attr("checked", true);
                    });
                } else {
                    $("input[name='ppareaname']").each(function () {
                        $(this).parent().removeClass("checked");
                        $(this).attr("checked", false);
                    });
                }
            });

            //全选联动
            $("input[name=bhareaname]").live("click", function () {
                var flag = true;
                $("input[name=bhareaname]").each(function () {
                    flag = flag && $(this).prop("checked");
                });
                $("#bhAreanameCheckAll").prop("checked", flag);
                $.uniform.update();
            });
            $("input[name=ppareaname]").live("click", function () {
                var flag = true;
                $("input[name=ppareaname]").each(function () {
                    flag = flag && $(this).prop("checked");
                });
                $("#ppAreanameCheckAll").prop("checked", flag);
                $.uniform.update();
            });
        });
    </script>
    @{Html.RegisterMvcPagerScriptResource();}
}
<div class="tabbable tabbable-custom">
    <ul class="nav nav-tabs" id="myTab">
        <li><a href="#divone">楼盘房号统计</a></li>
        <li><a href="#divtwo">楼盘图片统计</a></li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane" id="divone">
            @using (Html.BeginForm("Count", "Project", null, FormMethod.Get, new { id = "form1" }))
            {           
                <table class="tbsta">
                    <tr>
                        <td style="width: 80px;">行政区：
                        </td>
                        <td>
                            <input id="bhAreanameCheckAll" type="checkbox" value="-1" />
                            全市
                            @{
                var arealist = ViewData["areaid"] as IEnumerable<SelectListItem>;
                            }
                            @foreach (var item in arealist)
                            {
                                if (item.Value != "-1")
                                {
                                <input type="checkbox" name="bhareaname" value="@item.Value" /> @item.Text
                                }
                            }
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            @Html.Hidden("Type")
                            <button id="btnQuery1" class="btn">
                                查 询
                            </button>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <button id="btnExport1" class="btn">导 出</button>
                        </td>
                    </tr>
                </table>
            }
            @{
                var model1 = Model == null ? null : Model.BHCount;
            }
            @if (model1 != null)
            {
               
                <table class="table table-striped table-hover " style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th>行政区
                            </th>
                            <th>楼盘名称
                            </th>
                            <th>楼栋总数
                            </th>
                            <th>房号总数
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in model1)
                        {
                            <tr>
                                <td>
                                    @item.AreaName
                                </td>
                                <td>
                                    @item.ProjectName
                                </td>
                                <td>
                                    @item.BuildingNum
                                </td>
                                <td>
                                    @item.HouseName
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
                <div class="pager">
                    <div>共 @model1.TotalPageCount 页  @model1.TotalItemCount 条记录,当前为第 @Model.BHCount.CurrentPageIndex 页</div>
                    @Html.Pager(@model1, new PagerOptions { AutoHide = false, ShowPageIndexBox = true, PageIndexBoxType = PageIndexBoxType.TextBox })
                </div>              
            }
        </div>
        <div class="tab-pane" id="divtwo">
            @using (Html.BeginForm("Count", "Project", null, FormMethod.Get, new { id = "form2" }))
            { 
                <table class="tbsta" style="width: 960px;">
                    <tr>
                        <td style="width: 80px; height: 35px;">行政区：
                        </td>
                        <td>
                            <input id="ppAreanameCheckAll" type="checkbox" value="-1" />
                            全市
                            @{
                var arealist = ViewData["areaid"] as IEnumerable<SelectListItem>;
                            }
                            @foreach (var item in arealist)
                            {
                                if (item.Value != "-1")
                                {
                                <input type="checkbox" name="ppareaname" value="@item.Value" /> @item.Text
                                }
                            }
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 80px; height: 35px;">楼盘名称：
                        </td>
                        <td>@Html.TextBox("ProjectName")</td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            @Html.Hidden("Type")
                            <button id="btnQuery2" class="btn">
                                查 询
                            </button>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <button id="btnExport2" class="btn">导 出</button>
                        </td>
                    </tr>
                </table>
            }
            @{
                var model2 = Model == null ? null : Model.PPCount ?? null;
            }
            @if (model2 != null)
            {
                <table class="table table-striped table-hover " style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th>行政区
                            </th>
                            <th>楼盘名称
                            </th>
                            <th>图片总数
                            </th>
                            <th>logo
                            </th>
                            <th>标准层平面图
                            </th>
                            <th>户型图
                            </th>
                            <th>实景图
                            </th>
                            <th>外立面图
                            </th>
                            <th>位置图
                            </th>
                            <th>效果图
                            </th>
                            <th>总平面图
                            </th>
                            <th>其他
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in model2)
                        { 
                            <tr>
                                <td>
                                    @item.AreaName
                                </td>
                                <td>
                                    @item.ProjectName
                                </td>
                                <td>
                                    @item.PicCount
                                </td>
                                <td>
                                    @item.PicLogoNum
                                </td>
                                <td>
                                    @item.PicBZCNum
                                </td>
                                <td>
                                    @item.PicHXNum
                                </td>
                                <td>
                                    @item.PicSJNum
                                </td>
                                <td>
                                    @item.PicWLMNum
                                </td>
                                <td>
                                    @item.PicWZNum
                                </td>
                                <td>
                                    @item.PicXGNum
                                </td>
                                <td>
                                    @item.PicZPMNum
                                </td>
                                <td>
                                    @item.PicQTNum
                                </td>
                            </tr>
                
                        }
                    </tbody>
                </table>
                <div class="pager">
                    <div>共 @model2.TotalPageCount 页 @model2.TotalItemCount 条记录,当前为第 @model2.CurrentPageIndex 页</div>
                    @Html.Pager(model2, new PagerOptions { AutoHide = false, ShowPageIndexBox = true, PageIndexBoxType = PageIndexBoxType.TextBox })
                </div>
            }
        </div>
    </div>
</div>
