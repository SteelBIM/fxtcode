@using FXT.DataCenter.Domain.Models
@model DAT_CaseLand
@{
    Layout = "~/Views/Shared/_Layout.Edit.cshtml";
}
@section PageSpecificStyleSheetIncludes{
    <link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/Scripts/autocomplete/jquery.autocomplete.css")" />
    <style type="text/css">
        .tbInputCon
        {
            margin-top: 10px;
            margin-left: 30px;
            width: 95%;
            font-size: 14px;
            font-weight: normal;
            line-height: 20px;
            font-family: "Microsoft Yahei", "微软雅黑", "宋体", "Simsun", "Open Sans";
        }

        .ui-multiselect
        {
            height: 35px;
        }

        input.hasDatepicker
        {
            width: 205px;
        }

        .hidden
        {
            display: none;
        }
    </style>
}
@section PageSpecificJavascriptIncludes{
    <script src="@Url.Content("~/Content/Scripts/autocomplete/jquery.autocomplete.min.js")" type="text/javascript"></script>
    <script type="text/javascript">

        var urlSubArea = '@Url.Action("GetSubArea")';

        $(document).ready(function() {
            //日期控件渲染
            $("#startusabledate, #enddate, #casedate, #bargaindate, #windate, #arrangestartdate, #arrangeenddate, #dealdate").datepicker({ format: 'yyyy-mm-dd' });
            //行政区片区联动
            $("#areaid").change(function() {
                $("#areaname").val("");
                $("#areaname").val($('#areaid').find('option:selected').text());
                $.post(urlSubArea, { areaid: $("#areaid").val() }, function(data) {
                    $("#subareaid").html("");
                    $.each(data, function(i, item) {
                        $("#subareaid").append($("<option></option>").val(item.Value).html(item.Text));
                    });
                });
            });
            //areaName 赋初值
            var areaName = $("#areaid option:selected").text();
            $("#areaname").val(areaName);

            //宗地号下拉选择
            $('#landno').autocomplete('@Url.Action("GetLandNo")', {
                max: 12, //列表里的条目数
                minChars: 0, //自动完成激活之前填入的最小字符
                width: 218, //提示的宽度，溢出隐藏
                scrollHeight: 300, //提示的高度，溢出显示滚动条
                matchContains: true, //包含匹配，就是data参数里的数据，是否只要包含文本框里的数据就显示
                autoFill: false, //自动填充
                parse: function(data) {
                    return $.map(eval(data), function(row) {
                        return {
                            data: row,
                            value: row.landNo, //显示结果
                            result: row.landNo //填充结果
                        }
                    });
                },
                formatItem: function(row, i, max) {
                    return row.landNo;
                },
                formatMatch: function(row, i, max) {
                    return row.landNo;
                },
                formatResult: function(row) {
                    return row.landNo;
                }
            }).result(function(event, row, formatted) {
                $("#landno").val(row.landNo);
            });


            $("#Description").select2();
            $(".select2-container-multi").width(219);

            //展开
            $("#show").click(function() {
                var value = $(".hidden").css("display");
                if (value == "none") {
                    $(".expand").removeClass("hidden");
                    $("#show").text("收起∧");

                } else {
                    $(".expand").addClass("hidden");
                    $("#show").text("展开∨");
                }
            });


        });
    </script>
}
@section MainContent{
    <table class="tbInputCon">
        <tr>
            <td>
                @Html.HiddenFor(m => m.caseid)
                <a style="color: Red">*</a>行政区:
            </td>
            <td>
                <input id="areaname" name="areaname" type="hidden" />
                @Html.DropDownListFor(m => m.areaid, ViewBag.AreaName as List<SelectListItem>)
            </td>
            <td>片区:
            </td>
            <td>
                @Html.DropDownListFor(m => m.subareaid, ViewBag.SubAreaName as List<SelectListItem>)
            </td>
        </tr>
        <tr>
            <td>
                <a style="color: Red">*</a>宗地号:
            </td>
            <td>
                @Html.TextBoxFor(m => m.landno)
            </td>
            <td>
                <a style="color: Red">*</a>案例日期:
            </td>
            <td>
                @Html.TextBox("casedate",(Model==null ? string.Empty:Model.casedate.ToString("yyyy-MM-dd")))
            </td>
        </tr>
        <tr>
            <td>买卖方式:
            </td>
            <td>
                @Html.DropDownListFor(m => m.bargaintypecode, ViewBag.BargainType as List<SelectListItem>)
            </td>
            
            <td>建面地价(元/㎡):
            </td>
            <td>
                @Html.TextBoxFor(m => m.buildunitprice)
            </td>

        </tr>
        <tr>
            <td>土地单价(元/㎡):
            </td>
            <td>
                @Html.TextBoxFor(m => m.landunitprice)
            </td>
            <td>土地面积(㎡):
            </td>
            <td>
                @Html.TextBoxFor(m => m.landarea)
            </td>
        </tr>
        <tr>
            <td>起价(万元):
            </td>
            <td>
                @Html.TextBoxFor(m => m.minbargainprice)
            </td>
            <td>建筑面积(㎡):
            </td>
            <td>
                @Html.TextBoxFor(m => m.buildingarea)
            </td>
        </tr>
        <tr>
            <td>起始日期:
            </td>
            <td>
                @Html.TextBox("startusabledate",(Model==null?string.Empty:Model.startusabledate.HasValue?Model.startusabledate.Value.ToString("yyyy-MM-dd"):string.Empty))
            </td>
            <td>结束日期:
            </td>
            <td>
                @Html.TextBox("enddate",(Model==null?string.Empty:Model.enddate.HasValue?Model.enddate.Value.ToString("yyyy-MM-dd"):string.Empty))
            </td>
        </tr>
        <tr>
            <td>土地用途:
            </td>
            <td>
                @Html.DropDownListFor(m => m.landpurposecode, ViewBag.LandUse as List<SelectListItem>)
            </td>
            <td>规划用途:
            </td>
            <td>
                @Html.DropDownListFor(m => m.Description, ViewBag.LandPlanUse as List<SelectListItem>, new { multiple = true })               
            </td>
        </tr>
        <tr>
            <td>竞得者:
            </td>
            <td>
                @Html.TextBoxFor(m => m.winner)
            </td>
            <td>竞得时间:
            </td>
            <td>
                @Html.TextBox("windate",(Model==null?string.Empty:Model.windate.HasValue?Model.windate.Value.ToString("yyyy-MM-dd"):string.Empty))
            </td>
        </tr>
        <tr>
            <td>卖方(出让方)：
            </td>
            <td>
                @Html.TextBoxFor(m => m.seller)
            </td>
            <td>成交价(万元):
            </td>
            <td>
                @Html.TextBoxFor(m => m.dealtotalprice)
            </td>
        </tr>
        <tr>
            <td>成交日期:
            </td>
            <td>
                @Html.TextBox("dealdate",(Model==null?string.Empty:Model.dealdate.HasValue?Model.dealdate.Value.ToString("yyyy-MM-dd"):string.Empty))
            </td>
            <td>成交状态:
            </td>
            <td>
                @Html.DropDownListFor(m => m.bargainstatecode, ViewBag.BargainState as List<SelectListItem>)
            </td>
        </tr>
        <tr>
            <td>土地开发程度:
            </td>
            <td>
                @Html.DropDownListFor(m => m.developdegreecode, ViewBag.DevelopDegree as List<SelectListItem>)
            </td>
            <td>地址:
            </td>
            <td>
                @Html.TextBoxFor(m => m.landaddress)
            </td>
        </tr>
        <tr>
            <td>交易机构:
            </td>
            <td>
                @Html.TextBoxFor(m => m.bargainedby)
            </td>
            <td>备注:
            </td>
            <td>
                @Html.TextBoxFor(m => m.remark)
            </td>
        </tr>
        <tr>
            <td>挂牌日期:
            </td>
            <td>
                @Html.TextBox("bargaindate",(Model==null?string.Empty:Model.bargaindate.HasValue?Model.bargaindate.Value.ToString("yyyy-MM-dd"):string.Empty))
            </td>
            <td>土地使用年限:
            </td>
            <td>
                @Html.TextBoxFor(m => m.usableyear)
            </td>
        </tr>
        <tr class="expand hidden">
            <td>容积率(两位小数):
            </td>
            <td>
                @Html.TextBoxFor(m => m.cubagerate)
            </td>
            <td>最小容积率(两位小数):
            </td>
            <td>
                @Html.TextBoxFor(m => m.mincubagerate)
            </td>
        </tr>
        <tr class="expand hidden">
            <td>最大容积率(两位小数):
            </td>
            <td>
                @Html.TextBoxFor(m => m.maxcubagerate)
            </td>
            <td>覆盖率(两位小数):
            </td>
            <td>
                @Html.TextBoxFor(m => m.coverrate)
            </td>
        </tr>
        <tr class="expand hidden">
            <td>最大覆盖率(两位小数):
            </td>
            <td>
                @Html.TextBoxFor(m => m.maxcoverrate)
            </td>
            <td>联系电话:
            </td>
            <td>
                @Html.TextBoxFor(m => m.sourcephone)
            </td>
        </tr>
        <tr class="expand hidden">
            <td>土地来源:
            </td>
            <td>
                @Html.DropDownListFor(m => m.landsourcecode, ViewBag.LandSource as List<SelectListItem>)
            </td>
            <td>使用权性质:
            </td>
            <td>
                @Html.DropDownListFor(m => m.useTypeCode, ViewBag.UseTypeCodeName as List<SelectListItem>)
            </td>
        </tr>
        <tr class="expand hidden">
            <td>高度限制:
            </td>
            <td>
                @Html.TextBoxFor(m => m.heightlimited)
            </td>
            <td>规划限制:
            </td>
            <td>
                @Html.TextBoxFor(m => m.planlimited)
            </td>
        </tr>
        <tr class="expand hidden">
            <td>土地利用状况:
            </td>
            <td>
                @Html.TextBoxFor(m => m.landusestatus)
            </td>
            <td>土地等级:
            </td>
            <td>@Html.DropDownListFor(m => m.landclass, ViewBag.LandClassName as List<SelectListItem>)
            </td>
        </tr>
        <tr class="expand hidden">
            <td>绿化率(两位小数):
            </td>
            <td>
                @Html.TextBoxFor(m => m.greenrage)
            </td>
            <td>最小绿化率(两位小数):
            </td>
            <td>
                @Html.TextBoxFor(m => m.mingreenrage)
            </td>
        </tr>
        <tr class="expand hidden">
            <td>约定开工日期:
            </td>
            <td>
                @Html.TextBox("arrangestartdate",(Model==null?string.Empty:Model.arrangestartdate.HasValue?Model.arrangestartdate.Value.ToString("yyyy-MM-dd"):string.Empty))
            </td>
            <td>约定竣工日期:
            </td>
            <td>
                @Html.TextBox("arrangeenddate",(Model==null?string.Empty:Model.arrangeenddate.HasValue?Model.arrangeenddate.Value.ToString("yyyy-MM-dd"):string.Empty))
            </td>
        </tr>
        <tr class="expand hidden">
            <td>来源名称:
            </td>
            <td>
                @Html.TextBoxFor(m => m.sourcename)
            </td>
            <td>来源链接:
            </td>
            <td>
                @Html.TextBoxFor(m => m.sourcelink)
            </td>
            <td colspan="2"></td>
        </tr>
        <tr>
            <td colspan="4" style="text-align: right; padding-right: 65px;">
                <a id="show" style="cursor: pointer;">展开∨</a>
            </td>
        </tr>
    </table>
}
